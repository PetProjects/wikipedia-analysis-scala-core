{"paragraphs":[{"text":"%jdbc(hive)\nshow databases;","user":"anonymous","dateUpdated":"2017-08-16T13:22:31+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"database_name\ndefault\nfoodmart\nwikitrending\nxademo\n"}]},"apps":[],"jobName":"paragraph_1502691751321_-434127024","id":"20170814-062231_769028152","dateCreated":"2017-08-14T06:22:31+0000","dateStarted":"2017-08-16T13:22:31+0000","dateFinished":"2017-08-16T13:22:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6929"},{"text":"%jdbc(hive)\ncreate database if not exists wikitrending\n    comment 'i.dobrovolskiy hive homework 1 db'\n    location '/hdfs/user/idobrovolskiy/wikipedia-trending/hivedb'\n    with dbproperties ('creator'='i.dobrovolskiy','date'='16.08.2017');","user":"anonymous","dateUpdated":"2017-08-16T13:22:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1502691771050_1500436418","id":"20170814-062251_358402903","dateCreated":"2017-08-14T06:22:51+0000","dateStarted":"2017-08-16T13:22:27+0000","dateFinished":"2017-08-16T13:22:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6930"},{"text":"%jdbc(hive)\nuse wikitrending;\n\ndrop table data_range;\n\nCREATE EXTERNAL TABLE IF NOT EXISTS data_range (\n  wiki_id int,\n  wiki_title string,\n  wiki_url string,\n  dates struct<min_date: bigint, max_date: bigint, date_range: array<struct<since: bigint, until: bigint>>>,\n  top_tokens map<string, int>\n)\nSTORED AS PARQUET\nLOCATION '/user/idobrovolskiy/wikipedia-trending/wiki_index_date_ranges';","user":"anonymous","dateUpdated":"2017-08-17T10:22:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1502889727046_-1158083225","id":"20170816-132207_1882822889","dateCreated":"2017-08-16T13:22:07+0000","dateStarted":"2017-08-17T10:22:35+0000","dateFinished":"2017-08-17T10:22:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6931"},{"text":"%jdbc(hive)\nuse wikitrending;\n\n--show tables\n\n-- 50 bc - 50 ad (-737790,-701265)\n\nselect\n    tt.token, sum(tt.tcount) as total_tcount\nfrom (\n    select t.top_tokens\n    from data_range t\n    lateral view inline(t.dates.date_range) drs as since, until\n    where t.dates.min_date <= -701265 and t.dates.max_date >= -737790 and drs.since <=-701265 and drs.until >= -737790\n) t\nlateral view explode(t.top_tokens) tt as token, tcount\ngroup by tt.token\norder by total_tcount desc\nlimit 10;","user":"anonymous","dateUpdated":"2017-08-17T14:26:12+0000","config":{"colWidth":12,"enabled":true,"results":{"1":{"graph":{"mode":"scatterChart","height":354,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"tt.token","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"total_tcount","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"tt.token\ttotal_tcount\nroman\t107083\nbattle\t45988\nwar\t36189\ncaesar\t31264\nrome\t30291\nhan\t28480\nemperor\t27396\nempire\t22657\ncentury\t20370\ndynasty\t20114\n"}]},"apps":[],"jobName":"paragraph_1502890641154_-975389915","id":"20170816-133721_1138558760","dateCreated":"2017-08-16T13:37:21+0000","dateStarted":"2017-08-17T14:23:17+0000","dateFinished":"2017-08-17T14:23:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6932"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1502890856465_1863762519","id":"20170816-134056_446737486","dateCreated":"2017-08-16T13:40:56+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:6933"}],"name":"Hive WikiQuery 50 BC - 50 AD","id":"2CPNNP8CY","angularObjects":{"2CEW5GBT8:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CGSU7XSZ:shared_process":[],"2CJCXYWM2:shared_process":[],"2CGGK94TT:shared_process":[],"2CFK35D2R:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CFNPFVQG:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}